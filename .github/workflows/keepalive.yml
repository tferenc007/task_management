
name: Keep Streamlit Alive

on:
  schedule:
    - cron: "*/45 * * * *"   # co 15 minut 
  workflow_dispatch:         # pozwala uruchomić ręcznie

jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
      - name: Ping Streamlit app
        run: |
          URL="https://ebistf.streamlit.app/"
          echo "Pinging $URL"
          for i in 1 2 3; do
            STATUS=$(curl -s -o /dev/null -w "%{http_code}" --max-time 15 "$URL" || true)
            echo "Attempt $i -> HTTP $STATUS"
            if [ "$STATUS" -ge 200 ] && [ "$STATUS" -lt 400 ]; then
              echo "OK"
              exit 0
            fi
            sleep $((i * 5))
          done
          echo "Ping failed"
          exit 1
